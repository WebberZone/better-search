function bsearchCopyToClipboard(e){const a=document.getElementById(e);if(!a)return;const t=a.parentElement.querySelector(".bsearch-copy-button");t&&navigator.clipboard.writeText(a.textContent).then(()=>{const e=t.querySelector(".dashicons");e.classList.remove("dashicons-clipboard"),e.classList.add("dashicons-yes"),t.classList.add("copied"),t.title=better_search_admin.copied,setTimeout(()=>{e.classList.remove("dashicons-yes"),e.classList.add("dashicons-clipboard"),t.classList.remove("copied"),t.title=better_search_admin.copyToClipboard},2e3)}).catch(()=>{const e=t.querySelector(".dashicons");e.classList.remove("dashicons-clipboard"),e.classList.add("dashicons-warning"),t.classList.add("error"),t.title=better_search_admin.copyError,setTimeout(()=>{e.classList.remove("dashicons-warning"),e.classList.add("dashicons-clipboard"),t.classList.remove("error"),t.title=better_search_admin.copyToClipboard},2e3)})}function bsearchAddCopyButton(e){const a=document.getElementById(e);if(!a)return;const t=document.createElement("button");t.type="button",t.className="bsearch-copy-button",t.setAttribute("aria-label",better_search_admin.copyToClipboard),t.title=better_search_admin.copyToClipboard,t.onclick=()=>bsearchCopyToClipboard(e);const n=document.createElement("span");n.className="screen-reader-text",n.textContent=better_search_admin.copyToClipboard;const s=document.createElement("span");s.className="dashicons dashicons-clipboard",s.setAttribute("aria-hidden","true"),t.appendChild(n),t.appendChild(s);const c=a.parentElement;c&&c.classList.contains("bsearch-code-wrapper")&&c.appendChild(t)}jQuery(document).ready(function(e){e('button[name="bsearch_cache_clear"]').on("click",function(){if(confirm(bsearch_admin_data.strings.confirm_message)){var a=e(this);a.prop("disabled",!0).append(' <span class="spinner is-active"></span>'),function(a){e.post(ajaxurl,{action:"bsearch_clear_cache",security:bsearch_admin_data.security},function(e){e.success?alert(e.data.message):alert(bsearch_admin_data.strings.fail_message)}).fail(function(e,a){alert(bsearch_admin_data.strings.request_fail_message+a)}).always(function(){a.prop("disabled",!1).find(".spinner").remove()})}(a)}}),e(document).on("click",".bsearch-run-collation-fix",function(a){if(a.preventDefault(),window.confirm("Are you sure? Please backup your database before proceeding!")){var t=e(this),n=t.text();t.prop("disabled",!0).text("Running...").append(' <span class="spinner is-active" style="float: none; margin: 0 0 0 5px;"></span>'),e.post(ajaxurl,{action:"bsearch_run_collation_fix",blog_id:t.data("blog-id"),collation:t.data("collation"),security:bsearch_admin_data.security},function(e){e.success?(alert(e.data||"Collation updated successfully."),t.text("Fixed!").removeClass("button-danger").addClass("button-secondary")):alert(e.data||"Failed to update collation.")}).fail(function(e,a){alert("Request failed: "+a)}).always(function(){t.find(".spinner").remove(),"Fixed!"!==t.text()&&t.prop("disabled",!1).text(n)})}}),e(function(){e("#post-body-content").tabs({create:function(a,t){e(t.tab.find("a")).addClass("nav-tab-active")},activate:function(a,t){e(t.oldTab.find("a")).removeClass("nav-tab-active"),e(t.newTab.find("a")).addClass("nav-tab-active")}})}),e(function(){var a="dd M yy",t=e("#datepicker-from").datepicker({changeMonth:!0,changeYear:!0,maxDate:0,dateFormat:a}).on("change",function(){n.datepicker("option","minDate",s(this))}),n=e("#datepicker-to").datepicker({changeMonth:!0,changeYear:!0,maxDate:0,dateFormat:a}).on("change",function(){t.datepicker("option","maxDate",s(this))});function s(t){var n;try{n=e.datepicker.parseDate(a,t.value)}catch(e){n=null}return n}})});